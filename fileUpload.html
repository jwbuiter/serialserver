<!doctype html>
<html>
<head>
  <title>MBDCcomUnit</title>
   <style>
      *{font-size: 25px; padding:0;}
      table { text-align: center; border: none; border-collapse: collapse;}
      tr { height: 29px; }
      td { text-align: center;  border-style: bold; width: 12vw; height: 29px;}
      td.small { font-size: 15px; }
      input {text-align: center; width: 12vw;}
      input.wide {width: 28vw;}
      input[type="submit"]{width: auto;}
      select { width: 12vw; }
    </style>
</head>
<body>
  <div style="display: block; margin:0 auto;">
    <table id="content">
    </table>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/res/jquery-1.11.1.js"></script>
  <script src="/config.js"></script>
  <script type="text/javascript">
    const numColumns = 7;
    const numRows = 8;

    function address(rowNum, columnNum){
      return '#c' + columnNum + 'r' + rowNum;
    }

    for (let i = 0; i < numRows; i++){
      var currentRow = $('<tr>');
      $('#content').append(currentRow);
      for (let j = 0; j < numColumns; j++){
        currentRow.append($('<td>').attr('id', address(j, i).slice(1)));
      }
    }

    $(address(1, 6)).append($('<b>').html('File upload'));
    $(address(3, 6)).append($('<form id="uploadForm" action="upload" method="post" enctype="multipart/form-data">').html('<input class="wide" id="fileLocation" type="file" name="importFile" accept=".xls">'));
    $(address(3, 7)).append($('<input type="button" value="Import .xls" onclick="javascript:goSubmit()">'));

    $(address(4, 6)).append($('<input type="button" value="Cancel" onclick="javascript:goDebug()">'));
    $(address(5, 6)).append($('<input type="button" value="File settings" onclick="javascript:goFileSettings()">'));


    var socket = io();

    function setDate(){
      let dateTimeString = $('#date').val() + ' ' + $('#time').val()
      let dateTime = Date.parse(dateTimeString);
      socket.emit('setDateTime', dateTime/1000);
    }

    function goSubmit(){
      $('#uploadForm').submit();
    }

    function goDebug(){
      window.location.href = '/';
    }

    function goFileSettings(){
      window.location.href = '/filesettings';
    }
  </script>
</body>
</html>